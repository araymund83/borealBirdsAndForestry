createBCR_PROV_LCC_Estimates <- function(BCR = BCR,
                                     LCC05 = LCC05,
                                     densityEstimates = densityEstimates){
  
  # 2. Rasterize (fasterize) both PROV and BCR.
  
  # =========== BCR 
  message(crayon::yellow(paste0("Fasterizing BCRsf")))
  BCRsf <- sf::st_as_sf(BCR)
  BCRsf <- BCRsf[!is.na(BCRsf$PROVINCE_S),] # Excluding a weird NA from the polygons
  BCRsf <- BCRsf[!BCRsf$COUNTRY == "USA",] # Excluding the USA from the analysis
  rasBCR <- Cache(fasterize::fasterize, sf = BCRsf, raster = LCC05, field = "BCR",
                  userTags = "objectName:rasBCR")
  rasBCR[] <- rasBCR[]
  
  # # ==========+ PROV
  
  PROV_ID <- data.table(PROVINCE_S = unique(BCRsf$PROVINCE_S), ID = seq(200, 199 + length(unique(BCRsf$PROVINCE_S))))
  BCRsf$PROV_ID <- PROV_ID$ID[match(BCRsf$PROVINCE_S, PROV_ID$PROVINCE_S)]
  rasPROV <- Cache(fasterize::fasterize, sf = BCRsf, raster = LCC05, field = "PROV_ID",
                   userTags = "objectName:rasPROV")
  
  # 3. Create a lookout table
  
  PROVabb <- structure(list(PRENAME = structure(1:13, .Label = c("Alberta", 
                                                                 "British Columbia", "Manitoba", "New Brunswick", "Newfoundland and Labrador", 
                                                                 "Northwest Territories", "Nova Scotia", "Nunavut", "Ontario", 
                                                                 "Prince Edward Island", "Quebec", "Saskatchewan", "Yukon"), class = "factor"), 
                            ID = structure(c(207L, 206L, 200L, 210L, 201L, 202L, 211L, 203L, 209L, 212L, 
                                             204L, 208L, 205L), class = "numeric"), 
                            PROV = structure(c(1L, 2L, 3L, 4L, 5L, 7L, 6L, 8L, 9L, 10L, 
                                               11L, 12L, 13L), .Label = c("AB", "BC", "MB", "NB", "NL", 
                                                                          "NS", "NT", "NU", "ON", "PE", "QC", "SK", "YT"), class = "factor")), 
                       .Names = c("PRENAME", "ID", "PROV"), row.names = c(NA, -13L), class = "data.frame")
  
  # 4. Set a base data.table to retrieve the specific density values for each pixel 
  PROV_BCR_LCC <- data.table::data.table(ID = as.numeric(rasPROV[]),
                                         BCR = as.numeric(rasBCR[]),
                                         LCC = as.numeric(LCC05[]))
  browser()
  densityEstimates <- Cache(plyr::join, densityEstimates, PROVabb, cacheId = "densityEstimates")
  out <- list(PROV_BCR_LCC = PROV_BCR_LCC, 
              densityEstimates = densityEstimates)
  return(out)
}